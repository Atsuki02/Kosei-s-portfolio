---
import { optimizeImage } from "../../library/utils";

const { id, title, imageSrc, index } = Astro.props;

const formatIndex = (value: number) => `No. ${String(value + 1).padStart(2, "0")}`;
---

<a
  href={`/work/${id}`}
  class="group relative block aspect-[3/4] overflow-hidden bg-gray-100 transition-all duration-700 hover:-translate-y-2 hover:shadow-[0_20px_80px_-20px_rgba(0,0,0,0.2)] cursor-none"
>
  <div class="absolute inset-x-6 top-6 z-10 flex items-center justify-between text-[10px] uppercase tracking-[0.2em] text-white mix-blend-difference">
    <span class="rounded-full border border-white/40 px-3 py-1 backdrop-blur-md">{formatIndex(index)}</span>
    <span class="flex items-center gap-2 opacity-60 transition duration-300 group-hover:opacity-100">
      View Project
      <span class="h-px w-6 bg-white transition-all duration-300 group-hover:w-10" />
    </span>
  </div>

  <div class="absolute inset-0 overflow-hidden">
    <img
      src={optimizeImage(imageSrc, 800)}
      srcset={`${optimizeImage(imageSrc, 400)} 400w, ${optimizeImage(imageSrc, 800)} 800w, ${optimizeImage(imageSrc, 1200)} 1200w`}
      sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
      alt={title}
      class="h-full w-full object-cover transition duration-1000 ease-[cubic-bezier(0.22,1,0.36,1)] group-hover:scale-110"
      loading="lazy"
      decoding="async"
      width="800"
      height="1067"
    />
    {/* 白背景テーマに合わせて、オーバーレイは少し控えめにして画像の透明感を出す */}
    <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-40 transition duration-500 group-hover:opacity-30" />
  </div>
</a>
